<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Chatbot</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1a1d23;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            color: #fff; /* Ensure text is visible */
        }

        h1 {
            color: #fff;
            text-align: center;
            font-size: 24px;
            margin-bottom: 10px;
            padding-top: 20px; /* Add some padding at the top */
        }

        #chat-container {
            flex: 1;
            width: 90%; /* Adjusted for better mobile view */
            max-width: 800px; /* Max width for larger screens */
            margin: 0 auto 15px auto; /* Center and add margin at bottom */
            padding: 20px;
            overflow-y: auto;
            background-color: #1a1d23;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            border-radius: 10px; /* Unified border-radius */
            display: flex;
            flex-direction: column; /* Stack messages vertically */
        }

        #chat-container div {
            padding: 10px;
            border-bottom: 1px solid #2d3138;
            color: #fff;
            transform-style: preserve-3d;
            transform: translateZ(0);
            transition: transform 0.2s ease-in-out;
            border-radius: 8px; /* Rounded corners for messages */
            margin-bottom: 8px; /* Spacing between messages */
        }

        #chat-container div:last-child {
            border-bottom: none; /* No border for the last message */
        }

        #chat-container div:hover {
            transform: translateZ(5px); /* Slightly less aggressive hover for chat messages */
            background-color: #2d3138;
        }

        #input-area { /* Renamed from input-container for clarity in this standalone file */
            padding: 20px;
            background-color: #1a1d23;
            border-top: 1px solid #2d3138;
            display: flex;
            justify-content: center; /* Center the input elements */
            align-items: center;
            gap: 15px; /* Space between input and button */
            width: 90%; /* Match chat container width */
            max-width: 800px; /* Match chat container max-width */
            margin: 0 auto; /* Center horizontally */
            border-radius: 0 0 10px 10px; /* Rounded bottom corners */
        }

        #user-input {
            flex: 1; /* Allows input to grow */
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            background-color: #2d3138;
            color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        #send-btn {
            padding: 15px 25px; /* Adjusted padding for a better button size */
            border: none;
            border-radius: 10px;
            background-color: #4CAF50;
            color: #fff;
            cursor: pointer;
            font-size: 18px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            transition: background-color 0.3s ease, transform 0.2s ease; /* Smooth transition */
        }

        #send-btn:hover {
            background-color: #3e8e41;
            transform: translateY(-2px); /* Lift effect on hover */
        }

        #chat-container::-webkit-scrollbar {
            width: 10px;
            background-color: #1a1d23;
        }

        #chat-container::-webkit-scrollbar-thumb {
            background-color: #2d3138;
            border-radius: 10px;
        }

        /* Responsive design */
        @media only screen and (max-width: 600px) {
            #chat-container, #input-area {
                width: 95%; /* Slightly wider on smaller screens */
                padding: 15px; /* Reduced padding */
            }
            #user-input {
                padding: 12px;
                font-size: 16px;
            }
            #send-btn {
                padding: 12px 20px;
                font-size: 16px;
            }
            #input-area {
                flex-direction: row; /* Keep elements in a row */
                gap: 10px;
            }
        }

        @media only screen and (max-width: 400px) {
            #chat-container, #input-area {
                width: 98%; /* Even wider on very small screens */
                padding: 10px;
            }
            #user-input {
                padding: 10px;
                font-size: 14px;
            }
            #send-btn {
                padding: 10px 15px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <h1>Chatbot</h1>
    <div id="chat-container"></div>
    <div id="input-area"> <input type="text" id="user-input" placeholder="Type a command or /ai your question...">
        <button id="send-btn">Send</button>
    </div>

    <script>
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');

        // --- Configuration for your private AI endpoint ---
        // This is the endpoint you specified for the /ai command
        const PRIVATE_API_ENDPOINT = "https://api.giftedtech.my.id/api/ai/openai"; 
        const YOUR_API_KEY = "gifted"; // Your API key

        const commands = [
            { command: "help", response: ` <p>Available commands: ğŸ“š</p> <p>1. /help: Displays this list of available commands and their descriptions. ğŸ¤”</p> <p>2. /about: This is a chatbot developed to demonstrate various features and functionalities. ğŸ¤–</p> <p>3. /dev: Developed by a team of passionate developers. ğŸ’»</p> <p>4. /info: Provides information and entertainment through various commands. ğŸ“º</p> <p>5. /socials: You can find us on social media platforms: Twitter, Instagram, Facebook. ğŸ“±</p> <p>6. /joke: Why don't scientists trust atoms? Because they make up everything! ğŸ˜‚</p> <p>7. /quote: "Believe you can and you're halfway there." - Theodore Roosevelt ğŸ’¡</p> <p>8. /quest1: Explore the world of coding and discover new things. ğŸŒ</p> <p>9. /quest2: Learn a new programming language and build something amazing. ğŸ’»</p> <p>10. /update: We're constantly updating and improving our chatbot. ğŸš€</p> <p>11. /evaluate: Evaluates a prompt or idea based on creativity, clarity, relevance, and engagement. ğŸ“Š</p> <p>12. /theme: Our theme is to provide a user-friendly and interactive experience. ğŸŒˆ</p> <p>13. /reset: Chatbot has been reset. ğŸ”„</p> <p>14. /no.game: No game available at the moment. ğŸ˜”</p> <p>15. /ping: Pong! ğŸ“</p> <p>16. /uptime: Uptime: 24/7 â°</p> <p>17. /api: Our API is used to provide various services and functionalities. ğŸ“ˆ</p> <p>18. /calculate: Calculates mathematical expressions. ğŸ“Š</p> <p>19. /clear: Clears the chat ğŸ—‘ï¸</p> ` },
            { command: "about", response: "Switch 1.0 is a multipurpose online bot still in development with few inbuilt commands and integrated APIs. ğŸ¤–" },
            { command: "hi", response: "How are you doing today ğŸ˜Š" },
            { command: "what's up", response: "I'm good ğŸ‘Œ" },
            { command: "dev", response: "Created By Musa Abiodun ğŸ¤ Switch â„¢ and other members of the class of H.A.P.E ğŸ“ğŸ’». We're passionate about innovation and building cool stuff! ğŸš€" },
            { command: "info", response: "Provides information and entertainment through various commands. ğŸ“º" },
            { command: "socials", response: "You can find us on social media platforms: Twitter, Instagram, Facebook. ğŸ“±" },
            { command: "joke", response: "Why don't scientists trust atoms? Because they make up everything! ğŸ˜‚" },
            { command: "quote", response: "\"Believe you can and you're halfway there.\" - Theodore Roosevelt ğŸ’¡" },
            { command: "quest1", response: "Explore the world of coding and discover new things. ğŸŒ" },
            { command: "quest2", response: "Learn a new programming language and build something amazing. ğŸ’»" },
            { command: "update", response: "We're constantly updating and improving our chatbot. ğŸš€" },
            { command: "theme", response: "Our theme is to provide a user-friendly and interactive experience. ğŸŒˆ" },
            { command: "reset", response: "Chatbot has been reset. ğŸ”„" },
            { command: "no.game", response: "No game available at the moment. ğŸ˜”" },
            { command: "ping", response: "Pong! ğŸ“" },
            { command: "uptime", response: "Uptime: 24/7 â°" },
            { command: "api", response: "Our API is used to provide various services and functionalities. ğŸ“ˆ" },
            {
                command: "evaluate",
                response: () => {
                    const score = Math.floor(Math.random() * 100) + 1;
                    const encouragingWords = [
                        "Keep going!",
                        "You're on the right track!",
                        "Excellent work!",
                        "Don't give up!",
                        "You're making progress!",
                        "Great effort!",
                        "Good job!",
                        "Stay motivated!",
                        "You're doing well!",
                        "Keep pushing forward!",
                    ];
                    const encouragingWord =
                        encouragingWords[Math.floor(Math.random() * encouragingWords.length)];
                    return `<p>Evaluation Score: ${score}/100</p><p>${encouragingWord}</p>`;
                },
            },
        ];

        sendBtn.addEventListener("click", async () => { // Added 'async' keyword here
            const userInputValue = userInput.value.trim();
            if (userInputValue === "") return; // Prevent sending empty messages

            // Display user's message
            const userMessageDiv = document.createElement("div");
            userMessageDiv.textContent = `You: ${userInputValue}`;
            chatContainer.appendChild(userMessageDiv);

            // Clear input field immediately
            userInput.value = "";
            chatContainer.scrollTop = chatContainer.scrollHeight;

            // Check for built-in commands first
            if (userInputValue.toLowerCase().startsWith("/calculate")) {
                try {
                    const calculation = userInputValue.replace("/calculate ", "");
                    const result = eval(calculation); // Be cautious with eval() in production, as it can be a security risk.
                    const botMessage = document.createElement("div");
                    botMessage.innerHTML = `Bot: Result: ${result} ğŸ“Š`;
                    chatContainer.appendChild(botMessage);
                } catch (error) {
                    const errorMessage = document.createElement("div");
                    errorMessage.textContent = `Bot: Error: Invalid calculation ğŸ¤”`;
                    chatContainer.appendChild(errorMessage);
                }
            } else if (userInputValue.toLowerCase() === "/clear") {
                chatContainer.innerHTML = "";
            } else if (userInputValue.toLowerCase().startsWith("/ai")) {
                // --- Handle /ai command for API call ---
                const aiQuery = userInputValue.substring(3).trim(); // Extract query after "/ai "
                if (aiQuery === "") {
                    const botMessage = document.createElement("div");
                    botMessage.textContent = `Bot: Please provide a question after /ai. For example: /ai What is JavaScript?`;
                    chatContainer.appendChild(botMessage);
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                    return;
                }

                const thinkingMessageDiv = document.createElement("div");
                thinkingMessageDiv.innerHTML = `Bot: Thinking... ğŸ¤”`;
                chatContainer.appendChild(thinkingMessageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;

                try {
                    const encodedQuery = encodeURIComponent(aiQuery);
                    const url = `${PRIVATE_API_ENDPOINT}?apikey=${YOUR_API_KEY}&q=${encodedQuery}`;

                    const response = await fetch(url);

                    // Check if the HTTP response itself is not OK
                    if (!response.ok) {
                        let errorText = `HTTP Error: ${response.status} ${response.statusText}`;
                        try {
                            const errorData = await response.json();
                            if (errorData.message) {
                                errorText += ` - ${errorData.message}`;
                            }
                        } catch (jsonError) {
                            // If response is not JSON, use the status text
                        }
                        throw new Error(errorText);
                    }

                    const data = await response.json();

                    // Remove thinking message
                    if (chatContainer.contains(thinkingMessageDiv)) {
                        chatContainer.removeChild(thinkingMessageDiv);
                    }

                    const botMessage = document.createElement("div");
                    // *** MODIFIED HERE: Now specifically looking for 'data.result' ***
                    const botAnswer = data.result || JSON.stringify(data); // Fallback to stringify entire data if 'result' is not found

                    if (botAnswer) {
                        botMessage.innerHTML = `Bot: ${botAnswer}`;
                    } else {
                        botMessage.innerHTML = `Bot: I received an empty or unreadable response from the AI.`;
                    }
                    chatContainer.appendChild(botMessage);

                } catch (error) {
                    // Remove thinking message even on error
                    if (chatContainer.contains(thinkingMessageDiv)) {
                        chatContainer.removeChild(thinkingMessageDiv);
                    }
                    console.error("Error fetching from private API:", error);
                    const errorMessage = document.createElement("div");
                    errorMessage.textContent = `Bot: Sorry, I couldn't get a response from the AI. ${error.message ? `Error: ${error.message}` : 'Please check the network or try again later.'} ğŸ˜”`;
                    chatContainer.appendChild(errorMessage);
                }
            } else {
                // Handle other predefined commands
                const commandName = userInputValue.substring(1).toLowerCase();
                const command = commands.find((cmd) => cmd.command === commandName);
                if (command) {
                    const botMessage = document.createElement("div");
                    botMessage.innerHTML = `Bot: <br>${typeof command.response === "function" ? command.response() : command.response}`;
                    chatContainer.appendChild(botMessage);
                } else if (
                    userInputValue.toLowerCase().includes("hello") ||
                    userInputValue.toLowerCase().includes("hi") ||
                    userInputValue.toLowerCase().includes("hey")
                ) {
                    const botMessage = document.createElement("div");
                    botMessage.innerHTML = `Bot: How are you doing today ğŸ˜Š`; // Changed to a specific greeting
                    chatContainer.appendChild(botMessage);
                } else {
                    // Default response for unrecognized commands
                    const errorMessage = document.createElement("div");
                    errorMessage.textContent = `Bot: Sorry, I don't understand that command. Type /help for available commands. ğŸ˜•`;
                    chatContainer.appendChild(errorMessage);
                }
            }
            chatContainer.scrollTop = chatContainer.scrollHeight;
        });

        // Optional: Allow sending messages with Enter key
        userInput.addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                sendBtn.click();
            }
        });
    </script>
</body>
</html>

